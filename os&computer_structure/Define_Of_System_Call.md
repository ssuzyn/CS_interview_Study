## System call에 대해 설명해주세요

- 자료 조사
    
    ### 사족

- 운영체제 서비스
    
    ![OS_Service](https://github.com/JungMunGyu/CS_interview_Study/blob/main/os&computer_structure/img/OS_Service.png?raw=true)
    
    - **사용자 인터페이스**(User Interface) : 사용자 인터페이스는 크게 명령어 단위로 처리되는 **명령어 라인 인터페이스(CLI, Command-Line Interface)**와 **그래피컬 사용자 인터페이스(GUI, Graphical User Interface)**로 나뉜다. 우리가 도스나 윈도우 커맨드창 혹은 리눅스 터미널로 명령어를 입력해 파일이나 명령을 실행하는 것을 CLI, 윈도우나 Mac OS X 처럼 마우스를 통해 화면을 클릭하여 실행하는 방식을 GUI 방식이라고 한다.
    - **프로그램 실행**(Program execution) : 운영체제를 통해 프로그램을 메모리에 올려 프로세스로 만들고 실행시킬 수 있어야 한다.
    - **입출력 연산**(I/O operation) : 프로세스는 모니터나 파일을 통해 입출력을 시스템에게 요구할 수 있다. 일반적으로 사용자들은 입출력장치를 제어할 수 없다. 따라서 운영체제가 입출력에 대한 제어를 제공한다.
    - **파일 시스템 조작**(File system manipulation) : 프로그램은 파일을 읽거나 쓸 수 있어햐며, 이름으로 생성, 삭제, 검색할 수 있어야 한다. 또한 보안을 위해 파일, 디렉토리의 소유권에 대한 권한을 조정할 수 있다.
    - **통신**(Communication) : 운영체제에서의 통신 역할은 2가지로 나눌 수 있다. 첫 번째로 프로세스간의 통신이며, 이는 **공유 메모리** 를 통해 이루어 진다. 두 번째로 다른 시스템 간의 프로세스 통신이다. 이 때 통신은 메시지 전달(message passing) 기법을 사용해 이루어 지며, 패킷(packet)을 사용해 시스템간 프로세스 사이를 이동한다.
    - **오류 탐지**(Error detection) : 시스템에는 예측할 수 없는 오류가 언제나 발생할 수 있다. 운영체제는 이러한 사태에 대비해 언제나 각 타입에 오류에 대해 적당한 조치를 취할 준비가 되어 있어야 한다.

<aside>
💡 시스템의 효율적 작동을 위한 기능들도 존재한다. 아래와 같은 기능을 통해 시스템의 효율성을 증진 시킬 수 있다.

- **자원할당**(Resource allocation) : 다수의 사용자, 다수의 작업이 실행될 때 운영체제는 각 요소에 대해 효율적으로 자원을 할당 할 수 있어야 한다.
- **회계**(Accounting) : 특정 사용자, 특정 작업이 시스템의 자원을 얼마나 사용하는지 확인할 수 있어야 한다.
- **보호**(Protection)와 **보안**(Security) : 기본적으로 서로 다른 프로세스간의 간섭을 허용해서는 안되며, 외부에서의 불법적이거나 위협적인 접근을 차단/제어할 필요도 있다. 운영체제는 이러한 위협요소에 대해 예방책(precaution, 혹은 보안정책)을 수립할 필요가 있다.
</aside>

---

### 정의

**시스템 호출**(system call)은 운영 체제의 커널이 제공하는 서비스에 대해, 응용 프로그램의 요청에 따라 커널에 접근하기 위한 인터페이스이다. 보통 C나 C++과 같은 고급 언어로 작성된 프로그램들은 직접 시스템 호출을 사용할 수 없기 때문에 고급 API를 통해 시스템 호출에 접근하게 하는 방법이다.

---

### 시스템 콜이 필요한 이유

- 우리가 일반적으로 사용하는 프로그램은 '응용프로그램'이다. 유저레벨의 프로그램은 유저레벨의 함수들 만으로는 많은 기능을 구현하기 힘들기 때문에, 커널(kernel)의 도움을 반드시 받아야 합니다.
- 이러한 작업은 응용프로그램으로 대표되는 유저 프로세스(User Process)에서 유저모드에서는 수행할 수 없습니다. 반드시 **kernel**에 관련된 것은 커널모드로 전환한 후에야, 해당 작업을 수행할 권한이 생깁니다.
- 커널 모드를 통한 이러한 작업은 반드시 **시스템 콜**을 통해 수행하도록 설계되어 있습니다.

<aside>
💡 커널 영역의 기능을 사용자 모드가 사용 가능하게,  즉 프로세스가 하드웨어에 직접 접근해서 필요한 기능을 사용할 수 있게 해준다.

</aside>

---

### 권한은 왜 필요한가?

- 해커가 피해를 입히기 위해 악의적으로 시스템 콜을 사용하는 경우나 초보 사용자가 하드웨어 명령어를 잘 몰라서 아무렇게 함수를 호출했을 경우에 시스템 전체를 망가뜨릴 수도 있기 때문입니다. 따라서 이러한 명령어들은 특별하게 커널 모드에서만 실행할 수 있도록 설계되었고, 만약 유저 모드에서 시스템 콜을 호출할 경우에는 운영체제에서 불법적인 접근이라 여기고 trap을 발생시킵니다.

---

### 시스템 콜의 종류

- **프로세스 컨트롤**
    - 프로세스 생성 및 종료
    - 메모리에 로드, 실행
    - 프로세스 속성 값 확인, 지정
    - wait 이벤트, signal 이벤트
    - 메모리 할당
- **파일 메니지먼트**
    - 파일 생성, 파일 삭제
    - 열기, 닫기
    - 읽기, 쓰기, Reposition
    - 파일 속성 값 확인, 지정
- **디바이스 매니지먼트**
    - 디바이스 요청 및 해제
    - 읽기, 쓰기, Reposition
    - 디바이스 속성 확인, 지정
    - 비 물리적인 디바이스 해제 및 장착
- **정보 관리**
    - 시간 확인, 시간 지정
    - 시스템 데이터 확인, 지정
    - 프로세스, 파일, 디바이스 속성 가져오기
    - 프로세스, 파일, 디바이스 속성 설정하기
- **커뮤니케이션**
    - 커뮤니케이션 연결 생성 및 삭제
    - 메시지 송신, 수신
    - 상태 정보 전달
    - remote 디바이스 해제 및 장착
- **보안**
    - Permission 획득
    - Permission 설정

- 답안
    
    프로그램은 유저레벨의 함수들 만으로는 많은 기능을 구현하기 힘들기 때문에, 커널(kernel)의 도움을 반드시 받아야 합니다. 따라서 시스템 콜이 반드시 필요합니다. 시스템 콜은 운영 체제의 커널이 제공하는 서비스에 대해, 응용 프로그램의 요청에 따라 커널에 접근하기 위한 인터페이스입니다. 보통 C나 C++과 같은 고급 언어로 작성된 프로그램들은 직접 시스템 호출을 사용할 수 없기 때문에 고급 API를 통해 시스템 호출에 접근하게 하는 방법입니다. 따라서 커널 영역의 기능을 사용자 모드가 사용 가능하게,  즉 프로세스가 하드웨어에 직접 접근해서 필요한 기능을 사용할 수 있게 해줍니다.
    
-질문
    ![Call_Open](https://github.com/JungMunGyu/CS_interview_Study/blob/main/os&computer_structure/img/Call_Open.png?raw=true)

    ### 경우에 따라 시스템 콜이 발생했을 때, 추가적인 정보가 필요할 수도 있다. 그러한 경우 정보가 담긴 매개변수들을 OS에 어떻게 전달할까?

    - 매개변수를 CPU 레지스터에 전달한다.
    
    → 전달해야 하는 매개변수 보다 레지스터의 수가 작을 수 있다.
    
    → 다른 방법은 없나?
    
    -답
        1. 매개변수를 메모리에 저장해 해당 메모리의 주소를 레지스터에 전달 할 수 있다.
        2. 매개변수는 프로그램에 의해 스택(stack)에 전달(push) 될 수도 있다.
          위 경우 매개변수의 갯수나 길이의 제한이 없기 때문에 선호된다.
          
- Reference
    
    [운영체제 시스템콜(System Call)]https://fjvbn2003.tistory.com/306
    [운영체제 03 : 운영채제 서비스, 사용자 인터페이스]https://luckyyowu.tistory.com/132
