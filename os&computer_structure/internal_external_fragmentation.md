# 내부 단편화, 외부 단편화

### 1. 내부 단편화와 외부 단편화의 차이점이 무엇인가요?

> 내부 단편화는 메모리 할당 시 프로세스가 필요한 메모리보다 더 큰 메모리 블록을 할당 받았을 때 발생하는 현상으로, 할당된 메모리 블록 안에서의 빈 공간을 의미합니다. 
외부 단편화는 프로세스가 요청한 메모리 공간보다 총 메모리 공간이 크지만, 남아있는 공간이 연속적이지 않아 발생하는 현상으로, 할당되지 않은 빈 공간들의 총합을 의미합니다. 

내부 단편화는 하나의 메모리 블록 안에서 발생하며, 메모리 블록 크기와 할당된 프로세스의 크기가 관련이 있습니다. 반면에, 외부 단편화는 여러 개의 메모리 블록들 사이에서 발생하며, 할당된 메모리 블록들의 배치와 프로세스들의 크기와 수가 관련이 있다는 차이점이 있습니다.
> 

- 메모리 관리 기법
    
    **연속 메모리 관리**
    
    프로그램 전체가 메모리에 연속적으로 할당되어야 하는 관리 기법
    
    - 고정 분할 기법
        
        메모리가 고정된 파티션(길이)으로 분할 → 필요한 용량보다 더 큰 메모리 받으면 메모리 낭비 발생 → 내부 단편화 발생
        
    - 동적 분할 기법
        
        파티션들이 동적 생성, 자신의 크기와 같은 파티션에 적재 → 메모리 적재, 해제 반복하면서 낭비 메모리 발생 → 외부 단편화 발생
        
    
    **불연속 메모리 관리**
    
    프로그램의 일부가 서로 다른 주소 공간에 할당될 수 있는 기법
    
    - Page: 프로세스를 고정된 크기의 작은 블록들로 나눴을 때, 그 블록을 이르는 말
    - Frame: 페이지 크기와 같은 주 기억장치 메모리 블록
    - Segment: 서로 다른 크기의 논리적 단위
    
- 메모리 단편화 (Memory Fragmentation)
    
    컴퓨터에서 어떤 프로그램을 실행할 때, 메모리의 공간을 연속적인 형태로 할당하여 사용하게 된다.
    
    이렇게 프로그램이 메모리에 할당되고, 해제되고, 다시 새로운 프로그램이 할당되고, 해제되고를 반복하다보면
    
    **RAM에서 메모리의 공간이 작은 조각으로 나뉘어져 실제로는 사용가능한 메모리가 충분히 존재하지만 할당이 불가능한 상태가 발생하게 된다.**
    
    → 이를 메모리 단편화라 한다
    
    - 내부 단편화 (Internal Fragmentation)
        
        메모리 할당 시, 프로세스가 필요한 메모리보다 더 큰 메모리 블록을 할당 받았을 때 발생하는 현상
        
        ![Internal_fragmentation_1](https://user-images.githubusercontent.com/88701965/228523536-6a7f227a-6ccd-488f-b870-cd1006243a5c.png)
        
        ![Internal_fragmentation_2](https://user-images.githubusercontent.com/88701965/228523539-bb30b7d8-8481-4399-a4f1-cee96f3f7881.png)
        
        프로세스가 80MB의 메모리를 필요로 하지만, 100MB의 메모리 블록을 할당 받았다면 20MB의 메모리가 사용되지 않고 남게되는 문제가 발생한다.
        
    
    - 외부 단편화 (External Fragmentation)
        
        프로세스가 요청한 메모리 공간보다 총 메모리 공간이 크지만, 남아있는 공간이 연속적이지 않아 발생하는 현상
        
        ![External_fragmentation](https://user-images.githubusercontent.com/88701965/228523531-10997384-9eb9-4775-96fc-38ba029efd2d.png)
        
        남아있는 메모리 공간 = 50MB + 50MB = 100MB로
        
        요청한 메모리 공간 80MB보다 크지만, 남아있는 공간이 연속적이지 않아 프로세스 C를 할당할 수 없다. 따라서 남아있는 메모리 공간이 낭비되게 되는 문제가 발생한다.
        
- **내부 단편화 & 외부 단편화 차이점**
    
    
    | 내부 단편화 | 외부 단편화 |
    | --- | --- |
    | 할당된 메모리 블록 안에서의 빈 공간 | 할당되지 않은 빈 공간들의 총합 |
    | 하나의 메모리 블록 안에서 발생 | 여러 개의 메모리 블록들 사이에서 발생 |
    | 메모리 블록 크기와 할당된 프로세스의 크기가 관련되어 있음 | 할당된 메모리 블록들의 배치와 프로세스들의 크기와 수가 관련되어 있음 |
- 단편화 해결방법
    - 압축(Compaction)
        
        메모리 공간들을 재배치하여, 단편화로 인해 분산되어 있는 메모리 공간들을 하나로 합치는 기법
        
    - 통합(Coalescing)
        
        단편화로 인해 분산된 메모리 공간들을 인접해 있는 것 끼리 통합시켜 큰 메모리 공간으로 합치는 기법
        
    
    압축은 재배치가 일어나지만 통합은 인접한 공간들끼리 통합된다는 차이가 있다.
    
- 참고자료
    
    [[CS] 단편화, 세그멘테이션, 페이징(내부단편화 ,외부단편화)](https://velog.io/@tlsdnxkr/CS-단편화-세그멘테이션-페이징내부단편화-외부단편화)
    
    [[운영체제] 내부 단편화, 외부 단편화란? | 외부단편화 해결 방법](https://code-lab1.tistory.com/54)
    
    [외부 단편화의 해결책](https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&blogId=abyofasha&logNo=95480470)